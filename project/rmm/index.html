<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Termeh Shafie">
<meta name="description" content="The exploratory and confirmatory statistical analysis of multivariate social networks represented as multigraphs.">

<title>Termeh Shafie - Multigraph Representation of Network Data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<link href="../../static/favicon.png" rel="icon" type="image/png">
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
<link rel="stylesheet" href="../../academicons.css">
<meta property="og:title" content="Termeh Shafie - Multigraph Representation of Network Data">
<meta property="og:description" content="Termeh Shafie’s website and blog that mainly features the topics statistics, network science, and R">
<meta property="og:image" content="https://mrs.schochastics.net/project/rmm/featured.png">
<meta property="og:site_name" content="mrs schochastics">
<meta property="og:image:height" content="2059">
<meta property="og:image:width" content="4850">
<meta name="twitter:title" content="Termeh Shafie - Multigraph Representation of Network Data">
<meta name="twitter:description" content="Termeh Shafie’s website and blog that mainly features the topics statistics, network science, and R">
<meta name="twitter:image" content="https://mrs.schochastics.net/project/rmm/featured.png">
<meta name="twitter:creator" content="@termehshafie">
<meta name="twitter:site" content="@termehshafie">
<meta name="twitter:card" content="summary">
<meta name="twitter:image-height" content="2059">
<meta name="twitter:image-width" content="4850">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../static/logo.png" alt="" class="navbar-logo">
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about/index.html"> 
<span class="menu-text">About me</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../project/index.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../publications/index.html"> 
<span class="menu-text">Publications</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../talks/index.html"> 
<span class="menu-text">Talks</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog/index.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../teaching/index.html"> 
<span class="menu-text">Teaching</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../blog/index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#project-summary" id="toc-project-summary" class="nav-link active" data-scroll-target="#project-summary">Project summary</a></li>
  <li><a href="#r-package-multigraphr" id="toc-r-package-multigraphr" class="nav-link" data-scroll-target="#r-package-multigraphr">R package <code>multigraphr</code></a>
  <ul class="collapse">
  <li><a href="#package-overview" id="toc-package-overview" class="nav-link" data-scroll-target="#package-overview">Package overview</a></li>
  <li><a href="#installation" id="toc-installation" class="nav-link" data-scroll-target="#installation">Installation</a></li>
  </ul></li>
  <li><a href="#multigraphs-and-applicability" id="toc-multigraphs-and-applicability" class="nav-link" data-scroll-target="#multigraphs-and-applicability">Multigraphs and applicability</a></li>
  <li><a href="#multigraph-representation-of-network-data" id="toc-multigraph-representation-of-network-data" class="nav-link" data-scroll-target="#multigraph-representation-of-network-data">Multigraph representation of network data</a>
  <ul class="collapse">
  <li><a href="#random-multigraph-models" id="toc-random-multigraph-models" class="nav-link" data-scroll-target="#random-multigraph-models">Random multigraph models</a></li>
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example">Example</a></li>
  </ul></li>
  <li><a href="#statistics-to-analyze-structural-properties" id="toc-statistics-to-analyze-structural-properties" class="nav-link" data-scroll-target="#statistics-to-analyze-structural-properties">Statistics to analyze structural properties</a>
  <ul class="collapse">
  <li><a href="#example-contd" id="toc-example-contd" class="nav-link" data-scroll-target="#example-contd">Example (cont’d)</a></li>
  </ul></li>
  <li><a href="#goodness-of-fit-tests" id="toc-goodness-of-fit-tests" class="nav-link" data-scroll-target="#goodness-of-fit-tests">Goodness of fit tests</a></li>
  <li><a href="#simulated-goodness-of-fit-tests" id="toc-simulated-goodness-of-fit-tests" class="nav-link" data-scroll-target="#simulated-goodness-of-fit-tests">Simulated goodness of fit tests</a>
  <ul class="collapse">
  <li><a href="#example-1" id="toc-example-1" class="nav-link" data-scroll-target="#example-1">Example</a></li>
  </ul></li>
  <li><a href="#performing-the-goodness-of-fit-test-on-your-data" id="toc-performing-the-goodness-of-fit-test-on-your-data" class="nav-link" data-scroll-target="#performing-the-goodness-of-fit-test-on-your-data">Performing the goodness of fit test on your data</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header">
<h1 class="title display-7">Multigraph Representation of Network Data</h1>
<p class="author">Termeh Shafie</p>

</header>


<section id="project-summary" class="level2">
<h2 class="anchored" data-anchor-id="project-summary">Project summary</h2>
<p>Multigraphs are network representations in which multiple edges and edge loops (self edges) are permitted. Multigraph data structure can be observed directly but the possibility to obtain multigraphs using blocking, aggregation and scaling makes them widely applicable.</p>
<p>For the past decade, I’ve been working on a statistical framework for analyzing network data using this representation. I have developed different multigraph multigraph models and derived several statistics under these models that can be used to analyse local and global network properties in order to convey important social phenomena and processes. The latest contribution in this framework is formal goodness of fit tests for the developed probability models for random multigraphs.</p>
<p>The proposed framework is in full implemented in the R package ‘multigraphr’ and a description of various functions implemented in the package are given in the following. More details are provided in the package <a href="https://cran.r-project.org/web/packages/multigraphr/vignettes/multigraphr.html">vignette</a>and the references listed.</p>
</section>
<section id="r-package-multigraphr" class="level2">
<h2 class="anchored" data-anchor-id="r-package-multigraphr">R package <code>multigraphr</code></h2>
<section id="package-overview" class="level3">
<h3 class="anchored" data-anchor-id="package-overview">Package overview</h3>
<p><img src="hex_multigraphr.png" align="right" width="190px"> <a href="https://cran.r-project.org/package=multigraphr"><img src="https://www.r-pkg.org/badges/version/multigraphr.png" class="img-fluid" alt="CRAN status"></a> <a href="https://CRAN.R-project.org/package=multigraphr"><img src="http://cranlogs.r-pkg.org/badges/multigraphr.png" class="img-fluid" alt="CRAN Downloads"></a></p>
<p>This package introduces the multigraph framework for analyzing social network data. Brief description of various functions implemented in the package are given in the following but more details are provided in the package vignettes and the references listed.</p>
</section>
<section id="installation" class="level3">
<h3 class="anchored" data-anchor-id="installation">Installation</h3>
<p>You can install the released version of multigraphr from <a href="https://CRAN.R-project.org">CRAN</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"multigraphr"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The development version from <a href="https://github.com/">GitHub</a> with:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("devtools")</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"termehs/multigraphr"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="multigraphs-and-applicability" class="level2">
<h2 class="anchored" data-anchor-id="multigraphs-and-applicability">Multigraphs and applicability</h2>
<p>Multigraphs are network representations in which multiple edges and edge loops (self edges) are permitted. These data structures can be either directly observed or aggregated by classifying or cross-classifying node attributes into meta nodes. For the latter case, within group edges correspond to self-edges. See example below where the original graph with 15 nodes and 12 edges (left) is aggregated based on node categories into a small multigraph with 4 nodes (right).</p>
<p><img src="mg_ex1.png" align="center" width="750px"></p>
<p>Edge aggregation can also be used to obtain multigraphs. Assume that we study a graph with three different types of relations over three periods of time: <img src="mg_ex2.png" align="center" width="700px"></p>
<p>If we aggregate over time periods, we obtain for each edge category a multigraph for the total time period of three days:</p>
<p><img src="mg_ex3.png" align="center" width="700px"></p>
<p>For more details on these kinds of aggregations, see Shafie (2015;2016).</p>
</section>
<section id="multigraph-representation-of-network-data" class="level2">
<h2 class="anchored" data-anchor-id="multigraph-representation-of-network-data">Multigraph representation of network data</h2>
<p>Multigraphs are represented by their edge multiplicity sequence <strong>M</strong> with elements <em>M(i,j)</em>, denoting the number of edges at vertex pair sites <em>(i,j)</em> ordered according to <em>(1,1) &lt; (1,2) &lt;···&lt; (1,n) &lt; (2,2) &lt; (2,3) &lt;···&lt; (n,n)</em>, where <em>n</em> is number of nodes. The number of vertex pair sites is given by <em>r = n(n+1)/2</em>.</p>
<section id="random-multigraph-models" class="level3">
<h3 class="anchored" data-anchor-id="random-multigraph-models">Random multigraph models</h3>
<p>Two probability models for generating undirected random multigraphs are implemented in the package together with several statistics under these two models. Moreover, functions for goodness of fit tests are available for the presented models.</p>
<p>Note that some of the functions are only practical for small scale multigraphs.</p>
<p>The first model is obtained by random stub matching (RSM) given observed degree sequence of a multigraphs, so that edge assignments to vertex pair sites are dependent. The second is obtained by independent edge assignments (IEA) according to a common probability distribution. There are two ways in which an approximate IEA model can be obtained from an RSM model, thus facilitating the structural analysis. These two ways are</p>
<ul>
<li><p>independent stub assignment (ISA)</p></li>
<li><p>independent edge assignment of stubs (IEAS)</p></li>
</ul>
<p>(Shafie, 2016).</p>
</section>
<section id="example" class="level3">
<h3 class="anchored" data-anchor-id="example">Example</h3>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-2_2bf1b154e45b2f54af3bac7a4e68bac1">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">'multigraphr'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Consider a small graph on 3 nodes and the following adjacency matrix:</p>
<div class="cell" data-hash="index_cache/html/adj_0d01867ece636704a7825754aec7005e">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span>  <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>               <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>               <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>), </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>A</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]    1    1    0
[2,]    1    2    2
[3,]    0    2    0</code></pre>
</div>
</div>
<p>The degree sequence of the multigraph has double counted diagonals (edge stubs for loops) and is given by</p>
<div class="cell" data-hash="index_cache/html/degseq_3a6a90ce66a0a6d129cab458e439f21e">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fu">get_degree_seq</span>(<span class="at">adj =</span> A, <span class="at">type =</span> <span class="st">'graph'</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>D</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3 7 2</code></pre>
</div>
</div>
<p>so that number of edges in the multigraph is half the sum of the degree sequence which is equal to 6.</p>
<p>The RSM model given observed degree sequence shows the sample space consists of 7 possible multigraphs, as represented by their multiplicity sequence <code>m.seq</code> (each row correspond to the edge multiplicity sequence of a unique multigraph):</p>
<div class="cell" data-hash="index_cache/html/rsm_ex1_2a365332931a5337df96371d5595fced">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>rsm_1 <span class="ot">&lt;-</span> <span class="fu">rsm_model</span>(<span class="at">deg.seq =</span> D)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>rsm_1<span class="sc">$</span>m.seq</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  M11 M12 M13 M22 M23 M33
1   1   1   0   3   0   1
2   1   1   0   2   2   0
3   1   0   1   3   1   0
4   0   3   0   2   0   1
5   0   3   0   1   2   0
6   0   2   1   2   1   0
7   0   1   2   3   0   0</code></pre>
</div>
</div>
<p>with probabilities associated with each multigraph, together with statistics ‘number of loops’, ‘number of multiple edges’ and ‘simple graphs or not’:</p>
<div class="cell" data-hash="index_cache/html/rsm_ex2_478737e27139aca082846d39c44eb06d">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>rsm_1<span class="sc">$</span>prob.dists</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    prob.rsm loops multiedges simple
1 0.03030303     5          1      0
2 0.18181818     3          3      0
3 0.06060606     4          2      0
4 0.06060606     3          3      0
5 0.24242424     1          5      0
6 0.36363636     2          4      0
7 0.06060606     3          3      0</code></pre>
</div>
</div>
<p>Consider using the IEA model to approximate the RSM model so that edge assignment probabilities are functions of observed degree sequence. Note that the sample space for multigraphs is much bigger than for the RSM model so the multiplicity sequences are not printed (they can be found using the function <code>get_edgemultip_seq</code> for very small multigraphs and their probabilities can be found using the multinomial distribution). The following shows the number of multigraphs under either of the IEA models:</p>
<div class="cell" data-hash="index_cache/html/ieas_ex1_6490a4ac84dc0af600de54db7ede47c8">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>ieas_1 <span class="ot">&lt;-</span>   <span class="fu">iea_model</span>(<span class="at">adj =</span> A , <span class="at">type =</span> <span class="st">'graph'</span>,  <span class="at">model =</span> <span class="st">'IEAS'</span>, <span class="at">K =</span> <span class="dv">0</span>, <span class="at">apx =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>ieas_1<span class="sc">$</span>nr.multigraphs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 462</code></pre>
</div>
</div>
</section>
</section>
<section id="statistics-to-analyze-structural-properties" class="level2">
<h2 class="anchored" data-anchor-id="statistics-to-analyze-structural-properties">Statistics to analyze structural properties</h2>
<p>These statistics include number of loops (indicator of e.g.&nbsp;homophily) and number of multiple edges (indicator of e.g.&nbsp;multiplexity/interlocking), which are implemented in the package together with their probability distributions, moments and interval estimates under the different multigraph models.</p>
<section id="example-contd" class="level3">
<h3 class="anchored" data-anchor-id="example-contd">Example (cont’d)</h3>
<p>Under the RSM model, the first two moments and interval estimates of the statistics <em>M1</em> = ‘number of loops’ and <em>M2</em> = ‘number of multiple edges’ are given by</p>
<div class="cell" data-hash="index_cache/html/rsm_ex3_cbd95be167f797e68b643ecf5d24fcb4">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>rsm_1<span class="sc">$</span>M</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             M1    M2
Expected  2.273 3.727
Variance  0.986 0.986
Upper 95% 4.259 5.713
Lower 95% 0.287 1.741</code></pre>
</div>
</div>
<p>which are calculated using the numerically found probability distributions under RSM (no analytical solutions exist for these moments).</p>
<p>Under the IEA models (IEAS or ISA), moments of these statistics, together with the complexity statistic <span class="math inline">\(R_k\)</span> representing the sequence of frequencies of edge sites with multiplicities <em>0,1,…,k</em>, are found using derived formulas. Thus, there is no limit on multigraph size to use these. When the IEAS model is used to approximate the RSM model as shown above:</p>
<div class="cell" data-hash="index_cache/html/ieas_ex2_3a354713fdc420c4727666e57dbb00c0">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>ieas_1<span class="sc">$</span>M</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              M1    M2
Observed   3.000 3.000
Expected   2.273 3.727
Variance   1.412 1.412
Upper 95%  4.649 6.104
Lower 95% -0.104 1.351</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>ieas_1<span class="sc">$</span>R</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             R0     R1     R2
Observed  2.000  2.000  2.000
Expected  2.674  1.588  1.030
Variance  0.575  1.129  0.760
Upper 95% 4.191  3.713  2.773
Lower 95% 1.156 -0.537 -0.713</code></pre>
</div>
</div>
<p>When the ISA model is used to approximate the RSM model (see above):</p>
<div class="cell" data-hash="index_cache/html/isa_ex1_9993c76342cb4d3d433580bc2245e14c">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>isa_1 <span class="ot">&lt;-</span>   <span class="fu">iea_model</span>(<span class="at">adj =</span> A , <span class="at">type =</span> <span class="st">'graph'</span>,  </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">model =</span> <span class="st">'ISA'</span>, <span class="at">K =</span> <span class="dv">0</span>, <span class="at">apx =</span> <span class="cn">TRUE</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>isa_1<span class="sc">$</span>M</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             M1    M2
Observed  3.000 3.000
Expected  2.583 3.417
Variance  1.471 1.471
Upper 95% 5.009 5.842
Lower 95% 0.158 0.991</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>isa_1<span class="sc">$</span>R</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             R0     R1     R2
Observed  2.000  2.000  2.000
Expected  2.599  1.703  1.018
Variance  0.622  1.223  0.748
Upper 95% 4.176  3.915  2.748
Lower 95% 1.021 -0.509 -0.711</code></pre>
</div>
</div>
<p>The IEA models can also be used independent of the RSM model. For example, the IEAS model can be used where edge assignment probabilities are estimated using the observed edge multiplicities (maximum likelihood estimates):</p>
<div class="cell" data-hash="index_cache/html/ieas_ex3_15f94f8f9dd062ffb10769215bd44d22">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>ieas_2 <span class="ot">&lt;-</span>   <span class="fu">iea_model</span>(<span class="at">adj =</span> A , <span class="at">type =</span> <span class="st">'graph'</span>,  </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">model =</span> <span class="st">'IEAS'</span>, <span class="at">K =</span> <span class="dv">0</span>, <span class="at">apx =</span> <span class="cn">FALSE</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>ieas_2<span class="sc">$</span>M</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             M1    M2
Observed  3.000 3.000
Expected  3.000 3.000
Variance  1.500 1.500
Upper 95% 5.449 5.449
Lower 95% 0.551 0.551</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>ieas_2<span class="sc">$</span>R</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             R0     R1     R2
Observed  2.000  2.000  2.000
Expected  2.845  1.331  1.060
Variance  0.434  0.805  0.800
Upper 95% 4.163  3.125  2.849
Lower 95% 1.528 -0.464 -0.729</code></pre>
</div>
</div>
<p>The ISA model can also be used independent of the RSM model. Then, a sequence containing the stub assignment probabilities (for example based on prior belief) should be given as argument:</p>
<div class="cell" data-hash="index_cache/html/isa_ex2_3cba5b0336a4838d0d4fb6aa7cc494c6">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>isa_2 <span class="ot">&lt;-</span>   <span class="fu">iea_model</span>(<span class="at">adj =</span> A , <span class="at">type =</span> <span class="st">'graph'</span>,  </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">model =</span> <span class="st">'ISA'</span>, <span class="at">K =</span> <span class="dv">0</span>, <span class="at">apx =</span> <span class="cn">FALSE</span>, <span class="at">p.seq =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>))</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>isa_2<span class="sc">$</span>M</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              M1    M2
Observed   3.000 3.000
Expected   2.000 4.000
Variance   1.333 1.333
Upper 95%  4.309 6.309
Lower 95% -0.309 1.691</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>isa_2<span class="sc">$</span>R</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             R0     R1     R2
Observed  2.000  2.000  2.000
Expected  2.144  2.248  1.160
Variance  0.632  1.487  0.710
Upper 95% 3.734  4.687  2.845
Lower 95% 0.554 -0.190 -0.525</code></pre>
</div>
</div>
<p>The interval estimates can then be visualized to detect discrepancies between observed and expected values thus indicating social mechanisms at play in the generation of edges, and to detect interval overlap and potential interdependence between different types of edges (see Shafie 2015,2016; Shafie &amp; Schoch 2021).</p>
</section>
</section>
<section id="goodness-of-fit-tests" class="level2">
<h2 class="anchored" data-anchor-id="goodness-of-fit-tests">Goodness of fit tests</h2>
<p>Goodness of fits tests of multigraph models using Pearson (<em>S</em>) and information divergence (<em>A</em>) test statistics under the random stub matching (RSM) and by independent edge assignments (IEA) model, where the latter is either independent edge assignments of stubs (IEAS) or independent stub assignment (ISA). The tests are performed using goodness-of-fit measures between the edge multiplicity sequence of a specified model or an observed multigraph, and the expected multiplicity sequence according to a simple or composite hypothesis.</p>
</section>
<section id="simulated-goodness-of-fit-tests" class="level2">
<h2 class="anchored" data-anchor-id="simulated-goodness-of-fit-tests">Simulated goodness of fit tests</h2>
<p>Probability distributions of test statistics, summary of tests, moments of tests statistics, adjusted test statistics, critical values, significance level according to asymptotic distribution, and power of tests can be examined using <code>gof_sim</code> given a specified model from which we simulate observed values from, and a null or non-null hypothesis from which we calculate expected values from. This in order to investigate the behavior of the null and non-null distributions of the test statistics and their fit to to asymptotic chi-square distributions.</p>
<section id="example-1" class="level3">
<h3 class="anchored" data-anchor-id="example-1">Example</h3>
<p>Simulated goodness of fit tests for multigraphs with <em>n=4</em> nodes and <em>m=10</em> edges.</p>
<p><strong>(1) Testing a simple IEAS hypothesis with degree sequence (6,6,6,2) against a RSM model with degrees (8,8,2,2)</strong>:</p>
<div class="cell" data-hash="index_cache/html/gof1_8fbe93ef431debbe5d15842a9434302a">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>gof1 <span class="ot">&lt;-</span> <span class="fu">gof_sim</span>(<span class="at">m =</span> <span class="dv">10</span>, <span class="at">model =</span> <span class="st">'IEAS'</span>, <span class="at">deg.mod =</span> <span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">8</span>,<span class="dv">2</span>,<span class="dv">2</span>), </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">hyp =</span> <span class="st">'IEAS'</span>, <span class="at">deg.hyp =</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">6</span>,<span class="dv">6</span>,<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>(2) Testing a correctly specified simple IEAS hypothesis with degree sequence (14,2,2,2)</strong>:</p>
<div class="cell" data-hash="index_cache/html/gof2_1abeaf04b42b9ebee1d8ebbceeda472b">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>gof2 <span class="ot">&lt;-</span> <span class="fu">gof_sim</span>(<span class="at">m =</span> <span class="dv">10</span>, <span class="at">model =</span> <span class="st">'IEAS'</span>, <span class="at">deg.mod =</span> <span class="fu">c</span>(<span class="dv">14</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>), </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">hyp =</span> <span class="st">'IEAS'</span>, <span class="at">deg.hyp =</span> <span class="fu">c</span>(<span class="dv">14</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The non-null (<code>gof1</code>) and null (<code>gof2</code>) distributions of the test statistics together with their asymptotic chi2-distribution can be visualized using <code>ggplot2</code>:</p>
<p><img src="p1_gof_1.png" width="380" px=""> <img src="p2_gof_2.png" width="380" px=""></p>
<p><strong>(3) Testing a composite IEAS hypothesis against a RSM model with degree sequence (14,2,2,2)</strong>:</p>
<div class="cell" data-hash="index_cache/html/gof3_730ae590552a5520bbdcd2656cba2067">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>gof3 <span class="ot">&lt;-</span> <span class="fu">gof_sim</span>(<span class="at">m =</span> <span class="dv">10</span>, <span class="at">model =</span> <span class="st">'RSM'</span>, <span class="at">deg.mod =</span> <span class="fu">c</span>(<span class="dv">14</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>), </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">hyp =</span> <span class="st">'IEAS'</span>, <span class="at">deg.hyp =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>(4) Testing a composite ISA hypothesis against a ISA model with degree sequence (14,2,2,2)</strong>:</p>
<div class="cell" data-hash="index_cache/html/gof4_f05afc6744b3ade8d837daf493741155">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>gof4 <span class="ot">&lt;-</span> <span class="fu">gof_sim</span>(<span class="at">m =</span> <span class="dv">10</span>, <span class="at">model =</span> <span class="st">'ISA'</span>, <span class="at">deg.mod =</span> <span class="fu">c</span>(<span class="dv">14</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>), </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">hyp =</span> <span class="st">'ISA'</span>, <span class="at">deg.hyp =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The non-null (<code>gof3</code>) and null (<code>gof4</code>) distributions of the test statistics can then be visualized as shown above to check their fit to the asymptotic χ²-distribution.</p>
</section>
</section>
<section id="performing-the-goodness-of-fit-test-on-your-data" class="level2">
<h2 class="anchored" data-anchor-id="performing-the-goodness-of-fit-test-on-your-data">Performing the goodness of fit test on your data</h2>
<p>Use function <code>gof_test</code> to test whether the observed data follows IEA approximations of the RSM model. The null hypotheses can be simple or composite, although the latter is not recommended for small multigraphs as it is difficult to detect a false composite hypothesis under an RSM model and under IEA models (this can be checked and verified using <code>gof_sim</code> to simulate these cases).</p>
<p>Non-rejection of the null implies that the approximations fit the data, thus implying that above statistics under the IEA models can be used to further analyze the observed network. Consider the following multigraph from the well known Florentine family network with marital. This multigraphs is aggregated based on the three actor attributes wealth (W), number of priorates (P) and total number of ties (T) which are all dichotomized to reflect high or low economic, political and social influence (details on the aggregation can be found in Shafie, 2015):</p>
<p><img src="mg_flor.png" align="right" width="350px"></p>
<p>The multiplicity sequence represented as an upper triangular matrix for this mutigrpah is given by</p>
<div class="cell" data-hash="index_cache/html/flor1_0317d85f1d3ba3fc91256757f1177a5f">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>flor_m <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">matrix</span>(<span class="fu">c</span> (<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>                      <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>                      <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">5</span>,</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>                      <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>,</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>                      <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>,</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>                      <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">1</span>,</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>                      <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>,</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>                      <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">nrow=</span> <span class="dv">8</span>, <span class="at">ncol=</span><span class="dv">8</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The equivalence of adjacency matrix for the multigraph is given by</p>
<div class="cell" data-hash="index_cache/html/flor2_dde7f1e6545492b33c064c729e2c20de">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>flor_adj <span class="ot">&lt;-</span> flor_m<span class="sc">+</span><span class="fu">t</span>(flor_m)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>flor_adj </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]
[1,]    0    0    1    0    0    0    0    0
[2,]    0    0    0    0    0    0    0    0
[3,]    1    0    0    2    0    0    1    5
[4,]    0    0    2    0    0    0    1    1
[5,]    0    0    0    0    0    0    1    2
[6,]    0    0    0    0    0    0    2    1
[7,]    0    0    1    1    1    2    0    2
[8,]    0    0    5    1    2    1    2    2</code></pre>
</div>
</div>
<p>with the diagonal representing the loops double counted (Shafie, 2016). The function <code>get_degree_seq</code> can now be used to find the degree sequence for this multigraph:</p>
<div class="cell" data-hash="index_cache/html/flor3_8d3a4a5b9d4ee93d7abf230920ef98f0">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>flor_d <span class="ot">&lt;-</span> <span class="fu">get_degree_seq</span>(<span class="at">adj =</span> flor_adj, <span class="at">type =</span> <span class="st">'multigraph'</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>flor_d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  1  0  9  4  3  3  7 13</code></pre>
</div>
</div>
<p>Now we test whether the observed network fits the IEAS or the ISA model. The <span class="math inline">\(p\)</span>-values for testing whether there is a significant difference between observed and expected edge multiplicity values according to the two approximate IEA models are given in the output tables below. Note that the asymptotic χ²-distribution has <span class="math inline">\(r-1 = (n(n+1)/2) - 1 =35\)</span> degrees of freedom.</p>
<div class="cell" data-hash="index_cache/html/flor4_55b60cb865d5cdc9d5a749d15b0b0985">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>flor_ieas_test <span class="ot">&lt;-</span> <span class="fu">gof_test</span>(flor_adj, <span class="st">'multigraph'</span>, <span class="st">'IEAS'</span>, flor_d, <span class="dv">35</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>flor_ieas_test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Stat dof Stat(obs) p-value
1    S  35    15.762   0.998
2    A  35    18.905   0.988</code></pre>
</div>
</div>
<div class="cell" data-hash="index_cache/html/flor5_c1f866282ee9741f6b94bdc3a92f609a">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>flor_isa_test <span class="ot">&lt;-</span> <span class="fu">gof_test</span>(flor_adj, <span class="st">'multigraph'</span>, <span class="st">'ISA'</span>, flor_d, <span class="dv">35</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>flor_isa_test </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Stat dof Stat(obs) p-value
1    S  35    16.572   0.997
2    A  35    19.648   0.983</code></pre>
</div>
</div>
<p>The results show that we have strong evidence for the null such that we fail to reject it. Thus, there is not a significant difference between the observed and the expected edge multiplicity sequence according on the two IEA models. Statistics derived under these models presented above can thus be used to analyze the structure of these multigraphs.</p>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<ul>
<li><p>Shafie, T. (2015). A multigraph approach to social network analysis. <em>Journal of Social Structure</em>, 16. <a href="../../publications/multigraph_approach/index.html">Link</a></p></li>
<li><p>Shafie, T. (2016). Analyzing local and global properties of multigraphs. <em>The Journal of Mathematical Sociology</em>, 40(4), 239-264. <a href="../../publications/global_local_multigraphs/index.html">Link</a></p></li>
<li><p>Frank, O., Shafie, T., (2018). Random Multigraphs and Aggregated Triads with Fixed Degrees. <em>Network Science</em>, <strong>6</strong>(2), 232-250. <a href="../../publications/aggregated_triads/index.html">Link</a></p></li>
<li><p>Shafie, T., Schoch, D. (2021) Multiplexity analysis of networks using multigraph representations. <em>Statistical Methods &amp; Applications</em> 30, 1425–1444. <a href="../../publications/multiplexity/index.html">Link</a></p></li>
<li><p>Shafie, T. (2022). Goodness of fit tests for random multigraph models, <em>Journal of Applied Statistics</em>. <a href="../../publications/gof_multigraph/index.html">Link</a></p></li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p><b>© 2024 Termeh Shafie</b> <br> powered by ❤️ and <a href="https://quarto.org">quarto</a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://fosstodon.org/@termehs">
      <i class="bi bi-mastodon" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/termehshafie">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/termehs">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="https://scholar.google.de/citations?user=Si-WbhAAAAAJ&amp;hl=en">
<p><i class="ai ai-google-scholar" role="img"></i></p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="https://orcid.org/0000-0002-8419-8477">
<p><i class="ai ai-orcid" role="img"></i></p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="https://www.researchgate.net/profile/Termeh-Shafie">
<p><i class="ai ai-researchgate" role="img"></i></p>
</a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>